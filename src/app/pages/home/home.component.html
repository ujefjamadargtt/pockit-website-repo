<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
<div *ngIf="loadingPage" class="spinner-overlay">
  <div class="spinner-border text-primary spinner-size" role="status">
    <span class="sr-only"></span>
  </div>
</div>
<main class="main">
  <section id="hero" class="hero section card-white">
    <div class="carousel hero-carousel-container">
      <owl-carousel-o *ngIf="carouselItems.length > 0" [options]="carouselOptions" class="p-0">
        <ng-container *ngFor="let item of carouselItems">
          <ng-template carouselSlide>
            <div class="carousel-item">
              <div class="carousel-image" [ngStyle]="{
                  'background-image':
                    'url(' + IMAGEuRL + 'BannerImages/' + item.IMAGE_URL + ')',
                  'background-size': '100% 100%',
                  'background-position': 'center',
                  'background-repeat': 'no-repeat'
                }"></div>
              <div class="carousel-container text-left">
                <h3 [style.color]="item.TITLE_COLOR + ' !important'" class="carousel-title">
                  {{ item.TITLE }}
                </h3>
                <h6 [style.color]="item.SUB_TITLE_COLOR + ' !important'" class="carousel-title">
                  {{ item.SUB_TITLE }}
                </h6>
              </div>
            </div>
          </ng-template>
        </ng-container>
      </owl-carousel-o>
    </div>
  </section>
  <section id="agents" class="agents section p-10-pt-20" *ngIf="
      DefaultAddressArray?.TERRITORY_ID === 0 ||
      DefaultAddressArray?.TERRITORY_ID === null ||
      DefaultAddressArray.length === 0
    ">
    <div class="container d-flex flex-wrap justify-content-between align-items-start gap-4 p-0" data-aos="fade-up">
      <div
        class="card bg-white rounded-4 shadow pt-4 pb-4 ps-2 pe-2 text-center border-0 mt-2 service-categories pb-9-no-shadow">
        <div class="container section-title d-flex justify-content-between align-items-start pt-0-pb-7-bg-white">
          <div class="d-flex align-items-center">
            <span class="me-2 indicator-bar"></span>
            <p class="fw-bold m-0 responsive-text">
              {{ "home.service_categories.title" | translate }}
            </p>
          </div>
        </div>
        <div *ngIf="loadCategories1" class="spinner-border text-secondary mx-auto my-3" role="status">
          <span class="sr-only">Loading...</span>
        </div>
        <div *ngIf="!loadCategories1" class="row gy-4 w-100 scroll-container">
          <div *ngFor="let category of displayedCategories1; let i = index"
            class="col-12 col-sm-4 col-md-4 col-lg-2-3 col-xl-2-4 mt-18-mb-10" data-aos="fade-up"
            [attr.data-aos-delay]="(i + 1) * 100">
            <div class="popular-card flex-center-column-box" (click)="openServiceDrawerViewOnly(category)">
              <div class="bg-light-blue-p-10">
                <div [ngStyle]="{
                    'background-image':
                      'url(' +
                      (category.ICON
                        ? IMAGEuRL + 'Category/' + category.ICON
                        : 'assets/img/services/no-image.png') +
                      ')',
                    'background-size': '100% 100%',
                    'background-position': 'center',
                    'background-repeat': 'no-repeat',
                    width: '100%',
                    'aspect-ratio': '1 / 1',
                    'border-radius': '8px',
                    border: 'none'
                  }" class="img-fluid cc" role="img" [attr.aria-label]="category.title"></div>
              </div>
              <p class="service-name mt-2 text-center-preline-bold" [attr.title]="category.title">
                {{ category.title }}
              </p>
            </div>
          </div>
        </div>
        <div class="text-center w-100 mt-3" *ngIf="displayedCategories1.length < ServiceCateogriesView.length">
          <button class="btn btn-primary" (click)="loadMore2()" [disabled]="loadMoreLoading1">
            <span *ngIf="!loadMoreLoading1">Load More</span>
            <span *ngIf="loadMoreLoading1" class="spinner-border spinner-border-sm"></span>
          </button>
        </div>
      </div>
    </div>
  </section>
  <section *ngIf="userID !== 0 && PopularServices.length > 0" id="services" class="services section p-10-pt-20">
    <div
      class="container section-title d-flex justify-content-between align-items-start rounded-top-4 p-22-28-0-bg-white"
      data-aos="fade-up">
      <div class="d-flex align-items-center">
        <span class="me-2 indicator-bar"></span>
        <p class="fw-bold m-0 responsive-text">
          {{ "home.service_categories.popular_services" | translate }}
        </p>
      </div>
      <div class="view-catalogue">
        <span class="fw-600-pointer-orange" [routerLink]="['/services']">{{ "home.service_categories.view_all" |
          translate }}</span>
      </div>
    </div>
    <div class="container team d-flex justify-content-center align-items-center demo12 rounded-bottom-4 bg-white-pb-7">
      <div *ngIf="loadService" class="spinner-border text-secondary" role="status">
        <span class="sr-only"></span>
      </div>
      <div *ngIf="!loadService" class="row demo11 w-100">
        <owl-carousel-o *ngIf="PopularServices.length >= 4 || isMobile" [options]="carouselOptions1" [ngStyle]="{
            'max-width': PopularServices.length === 1 ? '300px' : '100%'
          }" class="p-0">
          <ng-container *ngFor="let service of PopularServices">
            <ng-template carouselSlide>
              <div class="popular-card p-12">
                <div class="bg-light-blue-p-10">
                  <div [ngStyle]="{
                      display: 'flex',
                      'align-items': 'center',
                      'background-color': '#f5f8fd',
                      padding: '10px !important',
                      'justify-content':
                        PopularServices.length === 1 ? 'unset' : 'center'
                    }" class="member" (click)="
                      userID !== 0 ? openDrawer(service) : openLoginModal()
                    ">
                    <div [ngStyle]="{
                        'background-image':
                          'url(' +
                          (service.SERVICE_IMAGE
                            ? IMAGEuRL + 'Item/' + service.SERVICE_IMAGE
                            : 'assets/img/services/no-image.png') +
                          ')',
                        'background-size': '100% 100%',
                        'background-position':
                          PopularServices.length === 1 ? 'center' : 'center',
                        'background-repeat': 'no-repeat',
                        width: PopularServices.length < 3 ? '100%' : '100%',
                        height: '150px',
                        'border-radius': '8px',
                        border: 'none',
                        cursor: 'pointer'
                      }" class="img-fluid cc" role="img" [attr.aria-label]="service.NAME"></div>
                  </div>
                </div>
                <p class="service-name" [attr.title]="service.NAME" [ngStyle]="{
                    'text-align':
                      PopularServices.length === 1 ? 'left' : 'center',
                    'white-space': 'pre-line',
                    color: '#0e0e0e',
                    'font-weight': '600',
                    margin: '0px'
                  }">
                  {{ service.NAME }}
                </p>
              </div>
            </ng-template>
          </ng-container>
        </owl-carousel-o>
        <div *ngIf="PopularServices.length < 4 && !isMobile" class="row w-100">
          <div class="col-12 col-md-4 col-sm-6 col-lg-2-3 col-xl-2-4 mb-3" *ngFor="let service of PopularServices">
            <div (click)="userID !== 0 ? openDrawer(service) : openLoginModal()">
              <div [ngStyle]="{
                  'background-image':
                    'url(' +
                    (service.SERVICE_IMAGE
                      ? IMAGEuRL + 'Item/' + service.SERVICE_IMAGE
                      : 'assets/img/services/no-image.png') +
                    ')',
                  'background-size': 'contain',
                  'background-position':
                    PopularServices.length === 1 ? 'center' : 'center',
                  'background-repeat': 'no-repeat',
                  width: '100%',
                  height: '150px',
                  'border-radius': '8px',
                  border: 'none',
                  'background-color': '#f5f8fd',
                  cursor: 'pointer'
                }" class="img-fluid cc" role="img" [attr.aria-label]="service.NAME"></div>
              <p class="service-name" [attr.title]="service.NAME">
                {{ service.NAME || "N/A" }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="addressModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static"
      data-bs-keyboard="false">
      <div class="modal-dialog modal-lg d-flex justify-content-center">
        <div class="modal-content max-w-80">
          <div class="modal-header">
            <h5 class="modal-title fw-bold">
              {{ "home.address_modal.title" | translate }}
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body overflow-auto max-h-400">
            <div *ngFor="let address of addresses" class="border rounded p-2 mb-2" [ngStyle]="
                (address.PINCODE_FOR === 'B' || address.PINCODE_FOR === 'S') &&
                address.TERRITORY_ID == defaultAddress.TERRITORY_ID
                  ? {}
                  : { display: 'none' }
              ">
              <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                  <input type="radio" name="address" [value]="address.ID" [(ngModel)]="selectedAddress" />
                  <div class="ms-2 fs-small-preline">
                    <span class="fw-bold">{{ address.NAME }}</span>
                    <p class="text-muted mb-0">
                      {{ address.ADDRESS_LINE_1 }}, {{ address.DISTRICT_NAME }}
                    </p>
                  </div>
                </div>
                <div *ngIf="customertype == 'I'">
                  <button class="btn btn-sm" (click)="editAddress(address)">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button *ngIf="!address.IS_DEFAULT" class="btn btn-sm text-danger"
                    (click)="deleteAddress(address.ID)">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer d-flex flex-column">
            <button type="button" class="btn btn-dark w-100" (click)="confirmAddress()">
              {{ "home.address_modal.select" | translate }}
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="offcanvas offcanvas-end custom-drawer w-558" data-bs-backdrop="static" tabindex="-1"
      id="serviceOffcanvas">
      <div *ngIf="loadepage" class="loading-overlay">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      <div *ngIf="!loadepage" class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title fw-bold fs-14">
          {{
          selectedService.CATEGORY_NAME ||
          ("servicejson.service_details" | translate)
          }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" (click)="getProjectData()"></button>
      </div>
      <div *ngIf="userID !== 0" class="progress">
        <div class="progress-bar bg-f36631" role="progressbar" [style.width.%]="homepageprogress"
          [attr.aria-valuenow]="homepageprogress" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div *ngIf="!loadepage" class="demodash offcanvas-body d-flex flex-column">
        <p class="device-type fs-13-mb-2">
          {{ "servicejson.selected_service" | translate }} :
          <span class="text-danger fw-bold ellipsis-text" [attr.title]="selectedService.NAME || 'N/A'"
            data-bs-toggle="tooltip" data-bs-placement="top">
            {{
            selectedService.NAME?.length > 40
            ? (selectedService.NAME | slice : 0 : 40) + "..."
            : selectedService.NAME || "N/A"
            }}
          </span>
        </p>
        <p class="text-muted fs-12">
          {{ "servicejson.enter_details" | translate }}
        </p>
        <div *ngIf="defaultAddress" (click)="openAddressModal()" class="border rounded p-3 mb-2 card-shadow-pointer">
          <div class="d-flex justify-content-between align-items-center">
            <span class="fw-bold fs-14">
              üè† {{ defaultAddress.ADDRESS_LINE_1 }},
              {{ defaultAddress.DISTRICT_NAME }}
            </span>
            <i class="bi bi-chevron-right"></i>
          </div>
          <p class="text-muted mb-0 fs-12">
            {{ defaultAddress.ADDRESS_LINE_2 }}, {{ defaultAddress.PINCODE }}
          </p>
        </div>
        <div class="border rounded p-3 bg-light shadow-sm border-bg-white">
          <p class="fw-bold mb-1 ellipsis-text" [attr.title]="selectedService.NAME || 'N/A'" data-bs-toggle="tooltip"
            data-bs-placement="top">
            {{
            selectedService.NAME?.length > 40
            ? (selectedService.NAME | slice : 0 : 40) + "..."
            : selectedService.NAME || "N/A"
            }}
          </p>
          <div *ngIf="customertype !== 'B'" class="d-flex justify-content-between text-muted">
            <span class="fs-12">{{
              "servicejson.base_price" | translate
              }}</span>
            <span *ngIf="customertype !== 'B'" class="fw-bold fs-13">
              ‚Çπ
              {{
              selectedService?.B2C_PRICE
              ? (selectedService.B2C_PRICE | number)
              : "0"
              }}
            </span>
          </div>
          <div class="d-flex justify-content-between text-muted">
            <span class="fs-12">
              {{
              customertype === "B"
              ? ("servicejson.sla" | translate)
              : ("servicejson.estimate_time" | translate)
              }}
            </span>
            <span class="fw-bold fs-13">
              {{
              (selectedService?.DURARTION_HOUR || 0) * 60 +
              (selectedService?.DURARTION_MIN || 0)
              }}
              min
            </span>
          </div>
          <div class="d-flex justify-content-between align-items-center mt-2">
            <span class="fs-12">{{
              "servicejson.quantity" | translate
              }}</span>
            <div class="input-group qty-box">
              <button class="btn btn-outline-secondary btn-sm fs-12" (click)="decreaseQty()">
                -
              </button>
              <input type="text" class="form-control text-center fs-12" [(ngModel)]="quantity" readonly />
              <button class="btn btn-outline-secondary btn-sm fs-12" (click)="increaseQty()">
                +
              </button>
            </div>
          </div>
        </div>
        <div class="mt-3 border rounded p-3 shadow-sm pb-120">
          <div class="d-flex justify-content-between align-items-center">
            <label class="form-label text-muted mb-0 fs-12">
              {{ "servicejson.brand_name" | translate }}
            </label>
            <span class="text-muted fs-12">(Optional)</span>
          </div>
          <input type="text" class="form-control custom-input fs-12" [(ngModel)]="selectedService.BRAND_NAME"
            placeholder=" {{ 'servicejson.enter_brand_name' | translate }}" maxlength="128"
            (focus)="isFocused = 'brandname'" (blur)="isFocused = ''" />
          <h6 class="text-red-fs-10-mt-4" *ngIf="
              isFocused === 'brandname' ||
              (data.BRAND_NAME != undefined &&
                data.BRAND_NAME != null &&
                data.BRAND_NAME != '' &&
                isFocused === 'brandname')
            ">
            {{ selectedService?.BRAND_NAME?.length || 0 }}/128
          </h6>
          <div class="d-flex justify-content-between align-items-center mt-3">
            <label class="form-label text-muted mb-0 fs-12">
              {{ "servicejson.model_number" | translate }}
            </label>
            <div class="d-flex align-items-center">
              <span class="text-muted me-1 fs-12">(Optional)</span>
              <i class="bi bi-info-circle text-primary cursor-pointer-fs-12" data-bs-toggle="modal"
                data-bs-target="#modelNumberModal22"></i>
            </div>
          </div>
          <input type="text" class="form-control custom-input fs-12" [(ngModel)]="selectedService.MODEL_NUMBER"
            placeholder=" {{ 'servicejson.enter_model_number' | translate }}" maxlength="60"
            (focus)="isFocused = 'model'" (blur)="isFocused = ''" />
          <h6 class="text-red-fs-10-mt-4" *ngIf="
              isFocused === 'model' ||
              (data.MODEL_NUMBER != undefined &&
                data.MODEL_NUMBER != null &&
                data.MODEL_NUMBER != '' &&
                isFocused === 'model')
            ">
            {{ selectedService?.MODEL_NUMBER?.length || 0 }}/60
          </h6>
          <div class="d-flex justify-content-between align-items-center mt-3">
            <label class="form-label text-muted mb-0 fs-12">{{
              "servicejson.upload_photo" | translate
              }}</label>
            <div class="d-flex align-items-center">
              <span class="text-muted me-1 fs-12">(Optional)</span>
              <i class="bi bi-info-circle text-primary cursor-pointer-fs-12" data-bs-toggle="modal"
                data-bs-target="#uploadPhotoModal"></i>
            </div>
          </div>
          <div class="upload-container d-flex align-items-center px-3">
            <span *ngIf="!selectedService.SERVICE_PHOTO_FILE" class="placeholder-text">
              {{ "servicejson.browse_photo" | translate }}</span>
            <span *ngIf="selectedService.SERVICE_PHOTO_FILE" class="text-truncate file-name"
              title="{{ selectedService.SERVICE_PHOTO_FILE }}">
              {{
              selectedService.SERVICE_PHOTO_FILE.length > 36
              ? (selectedService.SERVICE_PHOTO_FILE | slice : 0 : 36) +
              "..."
              : selectedService.SERVICE_PHOTO_FILE
              }}
            </span>
            <input #icon type="file" accept=".png, .jpg, .jpeg" (change)="fileChangeEvent($event)" class="file-input" />
            <i *ngIf="!selectedService.SERVICE_PHOTO_FILE" (change)="fileChangeEvent($event)"
              class="bi bi-upload upload-icon" (click)="icon.click()"></i>
            <div *ngIf="selectedService.SERVICE_PHOTO_FILE" class="d-flex align-items-center ms-2">
              <a href="javascript:void(0)" class="text-primary me-2" (click)="openModal()">
                <i class="bi bi-eye"></i>
              </a>
              <a href="javascript:void(0)" class="text-danger" (click)="removeImage()">
                <i class="bi bi-trash"></i>
              </a>
            </div>
          </div>
          <div *ngIf="isUploading" class="progress mt-2">
            <div class="progress-bar" role="progressbar" [style.width.%]="progressPercent"></div>
          </div>
          <div *ngIf="showModal" class="custom-modal">
            <div class="modal-content">
              <span class="custom-close-btn cursor-pointer" (click)="closeModal()">&times;</span>
              <img [src]="imagePreview" class="modal-img position-relative" alt="Uploaded Image" />
            </div>
          </div>
          <div class="d-flex justify-content-between align-items-center mt-3">
            <label class="form-label text-muted mb-0 fs-12">{{
              "servicejson.add_description" | translate
              }}</label>
            <span class="text-muted fs-12">(Optional)</span>
          </div>
          <textarea name="desc" class="form-control custom-input fs-12" rows="3"
            [(ngModel)]="selectedService.DESCRIPTION" placeholder="{{ 'servicejson.enter_description' | translate }}"
            maxlength="256" (focus)="isFocused = 'DESCRIPTION'" (blur)="isFocused = ''"></textarea>
          <h6 *ngIf="
              isFocused === 'DESCRIPTION' ||
              (data.DESCRIPTION && isFocused === 'DESCRIPTION')
            " class="text-red-fs-10-mt-4">
            {{ selectedService.DESCRIPTION?.length || 0 }}/256
          </h6>
        </div>
        <div class="drawer-footer mt-auto border-top pt-3 footer-absolute">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div class="col-12 text-center text-md-start mb-2 mb-md-0 p-0 flex-end">
                <button class="btn btn-outline-secondary bg-f8f9fa-text-black-fs-12 " (click)="getProjectData()"
                  data-bs-dismiss="offcanvas">
                  {{ "servicejson.back" | translate }}
                </button>
                <button (click)="openDrawer2(selectedService)" class="btn btn-dark btn-blue-white-fs-12"
                  [disabled]="!selectedService?.CATEGORY_NAME">
                  {{ "servicejson.next" | translate }}
                  <span class="text-muted text-white-fs-12">
                    ({{ "servicejson.select_address_slot" | translate }})
                  </span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="offcanvas offcanvas-end custom-drawer1 w-500" data-bs-backdrop="static" tabindex="-1"
      id="addressSlotDrawer">
      <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title fw-bold fs-14">
          {{ "home.address_slot.title" | translate }}
        </h5>
        <button type="button" class="btn-close" (click)="backaddress()" data-bs-dismiss="offcanvas"></button>
      </div>
      <div *ngIf="userID !== 0" class="progress">
        <div class="progress-bar bg-f36631" role="progressbar" [style.width.%]="homepageprogress"
          [attr.aria-valuenow]="homepageprogress" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="offcanvas-body">
        <div *ngIf="selectedService?.IS_EXPRESS === 1" class="border rounded p-3 bg-light card-shadow-fs-13">
          <div class="d-flex align-items-center">
            <input type="radio" id="expressService" name="serviceOption" checked class="me-2" />
            <label for="expressService" class="fw-bold fs-14">
              <i>{{ "home.express_service" | translate }}</i>
            </label>
          </div>
          <p class="text-muted fs-12">
            {{ "home.express_service_desc" | translate }}
            <b>{{
              selectedService?.EXPRESS_COST
              ? selectedService.EXPRESS_COST + " INR"
              : "N/A"
              }}</b>.
          </p>
          <div class="d-flex justify-content-center mt-2">
            <button class="btn w-50-fs-13" [ngClass]="{
                'btn-outline-primary': IS_EXPRESS === 0,
                'btn-outline-danger': IS_EXPRESS === 1
              }" (click)="toggleExpressService()">
              {{
              IS_EXPRESS === 1
              ? ("home.remove_express_service" | translate)
              : ("home.use_express_service" | translate)
              }}
            </button>
          </div>
        </div>
        <p class="text-center mt-3 fs-13">
          {{ "home.select_date_time" | translate }}
        </p>
        <div class="border date-time-container card-shadow-fs-13">
          <div class="date-picker-container">
            <label class="form-label fs-13">{{
              "home.select_date" | translate
              }}</label>
            <p class="selected-date fs-12">
              {{ selectedDate }}
            </p>
            <div class="date-scroll">
              <button *ngFor="let date of dates" class="date-button fs-12" [ngClass]="{
                  selected: selectedDate.trim() === date.fullDate.trim()
                }" [disabled]="holidaysdates.includes(date.fullDate)" (click)="selectDate(date.fullDate)">
                <span class="day">{{ date.display.split(" ")[0] }}</span>
                <span class="date">{{ date.display.split(" ")[1] }}</span>
              </button>
            </div>
          </div>
          <div class="time-slot-container">
            <label class="form-label fw-bold fs-13">
              {{ "home.select_time_slot" | translate }}
            </label>
            <div class="time-slot-wrapper">
              <div *ngFor="let period of timeSlots" class="time-slot">
                <p class="slot-title text-left-fs-13">
                  {{ period.period }}
                </p>
                <button class="slot-button" [ngClass]="{
                    'selected-slot':
                      selectedSlot ===
                      formatTime(period.times.start) +
                        ' - ' +
                        formatTime(period.times.end)
                  }" (click)="selectSlot(period.times)" [disabled]="period.times.disabled">
                  <span class="time-range">
                    {{ formatTime(period.times.start) }}<br />-<br />{{
                    formatTime(period.times.end)
                    }}
                  </span>
                </button>
              </div>
            </div>
          </div>
          <p *ngIf="isAllSlotsDisabled()" class="no-slots-message text-red-fs-14-mt-11">
            {{ "home.no_slots_available" | translate }}
          </p>
        </div>
        <div class="border p-3 mt-3 card-rounded-shadow-fs-13">
          <label class="form-label fw-bold fs-13">{{
            "home.remarks" | translate
            }}</label>
          <input type="text" class="form-control fs-12" [(ngModel)]="remark"
            [placeholder]="'home.remarks_placeholder' | translate" maxlength="256" (focus)="isFocused = 'REMARK'"
            (blur)="isFocused = ''" />
          <h6 *ngIf="isFocused === 'REMARK'" class="text-red-fs-10-mt-4">
            {{ remark?.length || 0 }}/256
          </h6>
        </div>
      </div>
      <div class="offcanvas-footer border-top p-3 d-flex align-items-center">
        <button class="btn btn-outline-secondary flex-grow-0 me-2 fs-13" (click)="backaddress()"
          data-bs-dismiss="offcanvas">
          {{ "home.back" | translate }}
        </button>
        <button class="btn btn-light flex-grow-0 me-2"></button>
        <button class="btn btn-dark flex-grow-1 text-white fs-14" (click)="bookNow()">
          {{ "home.confirm" | translate }}
        </button>
      </div>
    </div>
  </section>
  <section id="agents" class="agents section p-10-pt-20" *ngIf="OfferData.length > 0 || ServiceCateogries.length > 0">
    <div class="container d-flex flex-wrap justify-content-between align-items-start gap-4 p-0" data-aos="fade-up">
      <div
        class="card bg-white rounded-4 shadow pt-4 pb-4 ps-2 pe-2 text-center border-0 mt-2 shadow-sm service-categories pb-9-no-shadow"
        [ngClass]="{ 'full-width': OfferData.length === 0 }">
        <div class="container section-title d-flex justify-content-between align-items-start pt-0-pb-7-bg-white"
          data-aos="fade-up">
          <div class="d-flex align-items-center">
            <span class="me-2 indicator-bar"></span>
            <p class="fw-bold m-0 responsive-text">
              {{ "home.service_categories.title" | translate }}
            </p>
          </div>
        </div>
        <div
          class="container d-flex flex-column justify-content-center align-items-center bg-white-pb-22-pr-0-pl-0-m-auto">
          <div *ngIf="loadCategories" class="spinner-border text-secondary mx-auto" role="status">
            <span class="sr-only">{{
              "home.service_categories.loading" | translate
              }}</span>
          </div>
          <div *ngIf="!loadCategories" class="row gy-4 w-100 max-h-350-overflow-auto-pr-0">
            <div *ngFor="let category of displayedCategories; let i = index"
              class="col-12 col-sm-4 col-md-4 mt-18-mb-10" [ngClass]="
                OfferData.length === 0
                  ? 'col-lg-2-3 col-xl-2-4'
                  : 'col-lg-2-33 col-xl-2-44'
              " data-aos="fade-up" [attr.data-aos-delay]="(i + 1) * 100">
              <div class="popular-card flex-center-column-padded" (click)="openServiceDrawer(category)">
                <div class="bg-light-blue-p-10">
                  <div [ngStyle]="{
                      'background-image':
                        'url(' +
                        (category.ICON
                          ? IMAGEuRL + 'Category/' + category.ICON
                          : 'assets/img/services/no-image.png') +
                        ')',
                      'background-size': '100% 100%',
                      'background-position':
                        displayedCategories.length === 1 ? 'center' : 'center',
                      'background-repeat': 'no-repeat',
                      width: displayedCategories.length < 3 ? '100%' : '100%',
                      'aspect-ratio': '1 / 1',
                      'border-radius': '8px',
                      border: 'none'
                    }" class="img-fluid cc" role="img" [attr.aria-label]="category.title"></div>
                </div>
                <p class="service-name" [attr.title]="category.title" [ngStyle]="{
               'text-align': displayedCategories.length === 1 ? 'left' : 'center',
               'white-space': 'pre-line',
               color: '#0e0e0e',
               'font-weight': '600',
               'margin': '0px',
             }">
                  {{ category.title }}
                </p>
              </div>
            </div>
          </div>
          <div class="text-center w-100 mt-3" *ngIf="displayedCategories.length < ServiceCateogries.length">
            <button class="btn btn-primary" (click)="loadMore()" [disabled]="loadMoreLoading">
              <span *ngIf="!loadMoreLoading">Load More</span>
              <span *ngIf="loadMoreLoading" class="spinner-border spinner-border-sm"></span>
            </button>
          </div>
        </div>
      </div>
      <div *ngIf="OfferData.length > 0" class="offer-side align-self-center">
        <div class="offer-wrapper my-20">
          <div class="offer-carousel-container">
            <owl-carousel-o [options]="carouselOptions2" class="p-0">
              <ng-container *ngFor="let offer of OfferData">
                <ng-template carouselSlide>
                  <div class="offer-card" [ngStyle]="{
                      'background-image':
                        'url(' +
                        IMAGEuRL +
                        'BannerImages/' +
                        offer.IMAGE_URL +
                        ')',
                      'background-color': 'transparent',
                      'background-size': '100% 100%',
                      'background-position': 'center',
                      'background-repeat': 'no-repeat'
                    }">
                    <span [style.color]="offer.TITLE_COLOR" class="fs-20">{{ offer.TITLE }}</span>
                    <span [style.color]="offer.SUB_TITLE_COLOR" class="fs-14-preline">{{ offer.SUB_TITLE }}</span>
                  </div>
                </ng-template>
              </ng-container>
            </owl-carousel-o>
          </div>
        </div>
      </div>
    </div>
    <div class="offcanvas offcanvas-end custom-drawer12" data-bs-backdrop="static" id="isServiceDrawerOpen"
      tabindex="-1">
      <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title">{{ selectedService?.title }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" (click)="closeDrawer()"></button>
      </div>
      <div *ngIf="userID !== 0" class="progress">
        <div class="progress-bar bar-small-orange" role="progressbar" [style.width.%]="progress"
          [attr.aria-valuenow]="progress" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="offcanvas-body">
        <p class="fs-14-mb-2">
          <strong>{{ "home.service_drawer.selected_category" | translate }}:</strong>
          {{ selectedService?.title }}
        </p>
        <p class="text-muted fs-13-mb-8">
          {{ "home.service_drawer.select_service_type" | translate }}
        </p>
        <div *ngIf="loading" class="text-center my-3">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">{{
              "home.service_drawer.loading" | translate
              }}</span>
          </div>
        </div>
        <ul *ngIf="!loading" class="list-group list-container">
          <li *ngFor="let device of selectedService?.children"
            class="list-group-item list-group-item-action d-flex align-items-center shadow-sm"
            (click)="openActionDrawer(device)">
            <div class="circle-box">
              <img [src]="
                  device.ICON
                    ? IMAGEuRL + 'SubCategory/' + device.ICON
                    : 'assets/img/services/no-image.png'
                " alt="Device Image" class="img-40-contain" />
            </div>
            <span class="ms-3 flex-grow-1">{{ device.title }}</span>
            <i class="bi bi-chevron-right"></i>
          </li>
        </ul>
      </div>
      <div class="offcanvas-footer">
        <button class="btn btn-outline-secondary flex-grow-0 me-2 fs-13" (click)="closeDrawer()"
          data-bs-dismiss="offcanvas">
          {{ "home.service_drawer.back" | translate }}
        </button>
      </div>
    </div>
    <div class="offcanvas offcanvas-end show custom-drawer" *ngIf="isActionDrawerOpen" tabindex="-1">
      <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title">{{ selectedDevice?.title }}</h5>
        <button type="button" class="btn-close" (click)="isActionDrawerOpen = false"></button>
      </div>
      <div class="offcanvas-body">
        <p>
          <strong>{{ "home.service_details.selected_service" | translate }}:</strong>
          {{ selectedService?.title }}
        </p>
        <p>
          <strong>{{ "home.service_details.device_type" | translate }}:</strong>
          {{ selectedDevice?.title }}
        </p>
        <p>{{ "home.service_details.choose_action" | translate }}</p>
        <ul class="list-group list-container">
          <li *ngFor="let action of selectedDevice?.children"
            class="list-group-item list-group-item-action d-flex align-items-center"
            (click)="openActionDrawercomplete(action)">
            <img [src]="action.image" alt="Action Image" class="item-icon rounded-circle p-2" />
            <span class="ms-3 flex-grow-1">{{ action.title }}</span>
            <i class="bi bi-chevron-right"></i>
          </li>
        </ul>
      </div>
      <div class="offcanvas-footer">
        <button class="btn btn-outline-secondary flex-grow-0 me-2 fs-13" (click)="isActionDrawerOpen = false">
          {{ "home.service_drawer.back" | translate }}
        </button>
      </div>
    </div>
    <div class="offcanvas offcanvas-end show custom-drawer15" *ngIf="isDrawerOpen" tabindex="-1"
      data-bs-backdrop="static">
      <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title">{{ selectedService?.title }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" (click)="onBackClick()"></button>
      </div>
      <div *ngIf="userID !== 0" class="progress">
        <div class="progress-bar bg-f36631" role="progressbar" [style.width.%]="progress"
          [attr.aria-valuenow]="progress" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <div class="offcanvas-body">
        <p class="fs-14-mb-2">
          <span class="highlight-text r">
            {{ selectedService?.title }} >
            <span class="fw-bold"> {{ selectedDevice?.title }}</span>
          </span>
        </p>
        <p class="text-muted fs-13-mb-8">
          {{ "home.service_drawer.select_service_type" | translate }}
        </p>
        <div *ngIf="cartspinner" class="text-center my-3">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">{{
              "home.service_drawer.loading" | translate
              }}</span>
          </div>
        </div>
        <div *ngIf="!cartspinner">
          <div *ngFor="let service of servicesList" class="mb-3">
            <ng-container *ngIf="service.IS_PARENT == 0; else parentBlock">
              <div class="service-card1 p-3 shadow-sm border rounded pt-0-relative" (click)="
                  userID !== 0 ? openNextDrawer(service) : openLoginModal();
                  $event.stopPropagation()
                ">
                <div class="service-details d-flex align-items-center">
                  <div class="service-icon flex-center-h-140">
                    <div class="circle-box">
                      <img [src]="
                          service.SERVICE_IMAGE
                            ? IMAGEuRL + 'Item/' + service.SERVICE_IMAGE
                            : 'assets/img/services/no-image.png'
                        " class="item-iconnew img-40-contain-no-border" alt="Service Icon" />
                    </div>
                  </div>
                  <div class="flex-grow-1 ms-3 pt-15">
                    <h6 class="fw-bold mb-1 ellipsis-text-200" [attr.title]="service.NAME || 'N/A'"
                      data-bs-toggle="tooltip" data-bs-placement="top">
                      {{
                      service.NAME?.length > 35
                      ? (service.NAME | slice : 0 : 35) + "..."
                      : service.NAME || "-"
                      }}
                    </h6>
                    <div *ngIf="customertype !== 'B'" class="d-flex justify-content-between">
                      <p class="text-muted mb-1 fs-13">
                        {{ "home.service_card.base_price" | translate }}
                      </p>
                      <p *ngIf="customertype !== 'B'" class="fw-bold mb-1 fs-13">
                        ‚Çπ
                        {{
                        service?.B2C_PRICE
                        ? (service.B2C_PRICE | number)
                        : "0"
                        }}
                      </p>
                    </div>
                    <div class="d-flex justify-content-between">
                      <p class="text-muted mb-1 fs-13">
                        {{
                        customertype === "B"
                        ? "Estimated Duration"
                        : ("home.service_card.estimate_time" | translate)
                        }}
                      </p>
                      <p class="fw-bold mb-1 fs-13">
                        {{
                        (service?.DURARTION_HOUR || 0) * 60 +
                        (service?.DURARTION_MIN || 0)
                        }}
                        min
                      </p>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mt-2">
                      <p class="text-muted mb-1 fs-13">
                        {{ "home.service_card.qty" | translate }}
                      </p>
                    </div>
                    <div class="d-flex justify-content-between">
                      <span class="text-muted small">
                        <ng-container *ngFor="let star of [1, 2, 3, 4, 5]; let i = index">
                          <i class="fa mr-5" [ngClass]="
                              +service.AVG_RATINGS >= i + 1
                                ? 'fa fa-star text-warning'
                                : 'fa fa-star-o text-secondary'
                            "></i>
                        </ng-container>
                      </span>
                      <a *ngIf="service.AVG_RATINGS > 0" class="text-primary small mt-2 d-block cursor-pointer-fs-13"
                        (click)="openReviews(service, $event)">View reviews</a>
                    </div>
                  </div>
                  <span class="arrow-icon ms-2" (click)="
                      userID !== 0 ? openNextDrawer(service) : openLoginModal();
                      $event.stopPropagation()
                    ">
                    <i class="bi bi-chevron-right"></i>
                  </span>
                </div>
                <div class="d-flex align-items-center position-absolute-top-right">
                  <span *ngIf="service.IS_EXPRESS == 1" class="badge d-flex align-items-center btn-custom-left">
                    <i class="bi bi-lightning me-1 full-text"></i>
                    <span class="full-text">Express service</span>
                    <span class="short-text"><i class="bi bi-lightning me-1"></i></span>
                  </span>
                </div>
                <div class="d-flex mt-2">
                  <button
                    class="btn btn-light border rounded-3 w-50 me-2 px-4 py-2 d-flex justify-content-center align-items-center shadow-sm"
                    (click)="
                      openDescriptionModal(service); $event.stopPropagation()
                    ">
                    <span class="full-text">Service Description</span>
                    <span class="short-text">Description</span>
                  </button>
                  <button
                    class="btn btn-primary rounded-3 w-50 px-4 py-2 d-flex justify-content-center align-items-center shadow-sm">
                    <span>Next</span>
                    <i class="bi bi-arrow-right ms-2"></i>
                  </button>
                </div>
              </div>
              <div *ngIf="modalVisible1">
                <div class="backdrop"></div>
                <div class="map-container">
                  <div class="map-header btn-flex-space">
                    <div class="flex-center-column-full">
                      <p class="mb-0 fw-bold-fs-16-white">
                        User Location
                      </p>
                      <p class="small mb-0 fs-12-white">
                        Place the marker at your order location
                      </p>
                    </div>
                    <div class="text-end-p-6" *ngIf="gettruecondition()">
                      <button class="close-menu-btn" (click)="closeMap()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                          <line x1="18" y1="6" x2="6" y2="18"></line>
                          <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                      </button>
                    </div>
                  </div>
                  <div id="map"></div>
                  <div class="location-details">
                    <p>{{ locationAddress || "Fetching address..." }}</p>
                  </div>
                  <div class="map-footer">
                    <button [disabled]="!locationAddress" class="btn-primary1" (click)="confirmLocation()">
                      Confirm Location
                    </button>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-template #parentBlock>
              <ul class="list-group">
                <li class="list-group-item list-group-item-action d-flex align-items-center"
                  (click)="openActionDrawer(service)">
                  <img [src]="
                      service.SERVICE_IMAGE
                        ? IMAGEuRL + 'Item/' + service.SERVICE_IMAGE
                        : 'assets/img/services/no-image.png'
                    " alt="Device Image" class="item-icon rounded-circle p-2" />
                  <span class="ms-3 flex-grow-1">{{ service.NAME }}</span>
                  <i class="bi bi-chevron-right"></i>
                </li>
              </ul>
            </ng-template>
          </div>
        </div>
      </div>
      <div class="offcanvas-footer">
        <button class="btn btn-outline-secondary flex-grow-0 me-2 fs-13" data-bs-dismiss="offcanvas"
          (click)="onBackClick()">
          {{ "home.service_drawer.back" | translate }}
        </button>
      </div>
    </div>
  </section>
</main>
<div class="offcanvas offcanvas-end w-600" data-bs-backdrop="static" tabindex="-1" id="offcanvasRight11"
  aria-labelledby="offcanvasRightLabel" [class.show]="isDrawerVisible">
  <div *ngIf="!loadepage" class="offcanvas-header border-bottom">
    <h5 class="offcanvas-title fw-bold fs-14">
      {{ drawerData.CATEGORY_NAME || "Service Details" }}
    </h5>
    <button type="button" class="btn-close" (click)="drawerClose()"></button>
  </div>
  <div *ngIf="userID !== 0" class="progress">
    <div class="progress-bar bg-f36631" role="progressbar" [style.width.%]="progress" [attr.aria-valuenow]="progress"
      aria-valuemin="0" aria-valuemax="100"></div>
  </div>
  <div *ngIf="!loadepage" class="demodash offcanvas-body d-flex flex-column">
    <app-shared-subcategory-drawer *ngIf="userID !== 0 && isDrawerVisible" [data]="drawerData" [progress]="progress"
      [drawerClose]="closeCallback" [isDrawerVisible]="isDrawerVisible" [addresses]="addresses"
      [quantity]="cartquantity" [imagePreview]="imagePreview" [showModal]="showModal"
      [DefaultAddressArray]="DefaultAddressArray" [defaultAddress]="defaultAddress"></app-shared-subcategory-drawer>
  </div>
</div>
<div class="modal fade" id="modelNumberModal22" tabindex="-1" aria-labelledby="modelNumberModalLabel"
  data-bs-backdrop="static" data-bs-keyboard="false" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title fw-bold text-092b9c-fs-14" id="modelNumberModalLabel">
          How to Find Model Number
        </h6>
        <button type="button" class="btn-close fs-13" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <p class="mb-1 text-justify-fs-13">
          Check the underside of your laptop for a sticker or engraving labeled
          "Model" or "Model No." Refer to the image below for guidance.
        </p>
        <img src="assets/img/laptopproductno.png" class="img-fluid rounded shadow-sm" alt="Model Number Guide" />
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="uploadPhotoModal" tabindex="-1" aria-labelledby="uploadPhotoModalLabel" aria-hidden="true"
  data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title fw-bold text-092b9c-fs-14" id="uploadPhotoModalLabel">
          How to Upload a Photo
        </h6>
        <button type="button" class="btn-close fs-13" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <p class="mb-1 text-justify-fs-13">
          Make sure the photo clearly shows your device details.
        </p>
        <img src="assets/img/Laptopmodalno.jfif" class="img-fluid rounded shadow-sm" alt="Upload Photo Guide" />
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="guestModal" tabindex="-1" aria-labelledby="guestModalLabel" aria-hidden="true"
  data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content card-white-shadow">
      <div class="modal-header border-0">
        <h5 class="fw-bold m-auto text-333-fs-20">
          <i class="bi bi-person-circle"></i>
          {{ "home.guest_title" | translate }}
        </h5>
        <button type="button" class="btn-close ml-0" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p class="fs-15-color-555-line-15">
          {{ "home.guest_message" | translate }}
        </p>
      </div>
      <div class="modal-footer border-0 d-flex justify-content-center">
        <button type="button" class="btn btn-outline-dark px-4 py-2 rounded-pill border-black transition-fw-500"
          data-bs-dismiss="modal">
          <i class="bi bi-x-circle"></i> {{ "home.cancel" | translate }}
        </button>
        <button type="button" class="btn btn-primary px-4 py-2 rounded-pill btn-blue-500" (click)="redirectToLogin()">
          <i class="bi bi-box-arrow-in-right"></i>
          {{ "home.login" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="descriptionModal" tabindex="-1" aria-labelledby="descriptionModalLabel" aria-hidden="true"
  data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title fw-bold" id="descriptionModalLabel">
          Service Description
        </h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body description-content max-h-70vh-scroll">
        <div class="servicedesc" [innerHTML]="selectedServiceDescription"></div>
        <div *ngIf="serviceData?.SERVICE_DETAILS_IMAGE" class="text-center mt-3">
          <img [src]="
              IMAGEuRL +
              'ServiceDetailsImage/' +
              serviceData.SERVICE_DETAILS_IMAGE
            " class="img-fluid" alt="Service Image" />
        </div>
      </div>
    </div>
  </div>
</div>
<div class="offcanvas offcanvas-end custom-drawer12" data-bs-backdrop="static" id="viewOnlyServiceDrawer" tabindex="-1">
  <div class="offcanvas-header border-bottom">
    <h5 class="offcanvas-title">{{ viewOnlySelectedCategoryTitle }}</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
      (click)="closeViewOnlyCategoryDrawer()"></button>
  </div>
  <div class="offcanvas-body">
    <p class="fs-14-mb-2">
      <strong>Selected Category:</strong>
      {{ viewOnlySelectedCategoryTitle }}
    </p>
    <p class="text-muted fs-12-mb-8">
      Select a sub Category:
    </p>
    <div *ngIf="loadingViewOnly" class="text-center my-3">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    <ul *ngIf="!loadingViewOnly && viewOnlySubCategories.length" class="list-group list-container max-height-500">
      <li *ngFor="let device of viewOnlySubCategories"
        class="list-group-item list-group-item-action d-flex align-items-center shadow-sm"
        (click)="openActionDrawerViewOnly(device, 'parrent0')">
        <div class="circle-box">
          <img [src]="
              device.ICON
                ? IMAGEuRL + 'SubCategory/' + device.ICON
                : 'assets/img/services/no-image.png'
            " alt="Device Image" class="img-40-contain" />
        </div>
        <span class="ms-3 flex-grow-1">{{ device.title }}</span>
        <i class="bi bi-chevron-right"></i>
      </li>
    </ul>
    <div *ngIf="!loadingViewOnly && viewOnlySubCategories.length === 0" class="text-center text-muted">
      No subcategories available.
    </div>
  </div>
  <div class="offcanvas-footer">
    <button class="btn btn-outline-secondary flex-grow-0 me-2 fs-13" (click)="closeViewOnlyCategoryDrawer()"
      data-bs-dismiss="offcanvas">
      Back
    </button>
  </div>
</div>
<div class="offcanvas offcanvas-end custom-drawer15" id="viewOnlyServiceDrawerFinal" tabindex="-1"
  data-bs-backdrop="static">
  <div class="offcanvas-header border-bottom">
    <h5 class="offcanvas-title">{{ viewOnlySelectedCategoryTitle }}</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" (click)="closeFinalDrawer()"></button>
  </div>
  <div class="offcanvas-body">
    <p class="text-size-14-mb-1">
      <span class="highlight-text r fs-14">
        {{ viewOnlySelectedCategoryTitle }} >
        <span class="fw-bold">
          {{ selectedDevicename }}
        </span>
      </span>
    </p>
    <p class="text-muted fs-14">Select a service type</p>
    <div *ngIf="cartspinner" class="text-center my-3">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    <div *ngIf="!cartspinner">
      <div *ngFor="let service of viewOnlyServicesList" class="mb-3">
        <ng-container *ngIf="service.IS_PARENT == 0; else parentBlock">
          <div class="service-card1 p-3 shadow-sm border rounded pt-0-relative" (click)="openSuggestionModal()">
            <div class="service-details d-flex align-items-center">
              <div class="service-icon flex-center-h-140">
                <div class="circle-box">
                  <img [src]="
                      service.SERVICE_IMAGE
                        ? IMAGEuRL + 'Item/' + service.SERVICE_IMAGE
                        : 'assets/img/services/no-image.png'
                    " class="item-iconnew img-40-contain-no-border" alt="Service Icon" />
                </div>
              </div>
              <div class="flex-grow-1 ms-3 pt-15">
                <h6 class="fw-bold mb-1 ellipsis-text-200" [attr.title]="service.NAME || 'N/A'" data-bs-toggle="tooltip"
                  data-bs-placement="top">
                  {{
                  service.NAME?.length > 35
                  ? (service.NAME | slice : 0 : 35) + "..."
                  : service.NAME || "-"
                  }}
                </h6>
                <div *ngIf="customertype !== 'B'" class="d-flex justify-content-between">
                  <p class="text-muted mb-1 fs-13">
                    {{ "home.service_card.base_price" | translate }}
                  </p>
                  <p *ngIf="customertype !== 'B'" class="fw-bold mb-1 fs-13">
                    ‚Çπ
                    {{
                    service?.B2C_PRICE ? (service.B2C_PRICE | number) : "0"
                    }}
                  </p>
                </div>
                <div class="d-flex justify-content-between">
                  <p class="text-muted mb-1 fs-13">
                    {{
                    customertype === "B"
                    ? "Estimated Duration"
                    : ("home.service_card.estimate_time" | translate)
                    }}
                  </p>
                  <p class="fw-bold mb-1 fs-13">
                    {{
                    (service?.DURARTION_HOUR || 0) * 60 +
                    (service?.DURARTION_MIN || 0)
                    }}
                    min
                  </p>
                </div>
                <div class="d-flex justify-content-between align-items-center mt-2">
                  <p class="text-muted mb-1 fs-13">Qty</p>
                  <div>
                    <ng-container *ngIf="!service.QUANTITY || service.QUANTITY === 0">
                    </ng-container>
                  </div>
                </div>
                <div class="d-flex justify-content-between">
                  <span class="text-muted small">
                    <ng-container *ngFor="let star of [1, 2, 3, 4, 5]; let i = index">
                      <i class="fa mr-5" [ngClass]="
                          +service.AVG_RATINGS >= i + 1
                            ? 'fa fa-star text-warning'
                            : 'fa fa-star-o text-secondary'
                        "></i>
                    </ng-container>
                  </span>
                  <a *ngIf="service.AVG_RATINGS > 0" class="text-primary small mt-2 d-block cursor-pointer-fs-13"
                    (click)="openReviews(service, $event)">
                    View reviews
                  </a>
                </div>
              </div>
            </div>
            <div class="d-flex align-items-center position-absolute-top-right">
              <span *ngIf="service.IS_EXPRESS == 1" class="badge d-flex align-items-center left-rounded-blue-label">
                <i class="bi bi-lightning me-1 full-text"></i>
                <span class="full-text">Express service</span>
                <span class="short-text"><i class="bi bi-lightning me-1"></i></span>
              </span>
            </div>
            <div class="d-flex mt-2">
              <button
                class="btn btn-light border rounded-3 w-50 me-2 px-4 py-2 d-flex justify-content-center align-items-center shadow-sm"
                (click)="
                  openDescriptionModal(service); $event.stopPropagation()
                ">
                <span class="full-text">Service Description</span>
                <span class="short-text">Description</span>
              </button>
              <button
                class="btn btn-primary rounded-3 w-50 px-4 py-2 d-flex justify-content-center align-items-center shadow-sm"
                (click)="openSuggestionModal()">
                <span>Next</span>
                <i class="bi bi-arrow-right ms-2"></i>
              </button>
            </div>
          </div>
        </ng-container>
        <ng-template #parentBlock>
          <ul class="list-group">
            <li class="list-group-item list-group-item-action d-flex align-items-center"
              (click)="openActionDrawerViewOnly(service, 'parrent1')">
              <img [src]="
                  service.SERVICE_IMAGE
                    ? IMAGEuRL + 'Item/' + service.SERVICE_IMAGE
                    : 'assets/img/services/no-image.png'
                " class="item-icon rounded-circle p-2" alt="Service Image" />
              <span class="ms-3 flex-grow-1">{{ service.NAME }}</span>
              <i class="bi bi-chevron-right"></i>
            </li>
          </ul>
        </ng-template>
      </div>
    </div>
  </div>
  <div class="offcanvas-footer">
    <button class="btn btn-outline-secondary" (click)="closeFinalDrawer()" data-bs-dismiss="offcanvas">
      Back
    </button>
  </div>
</div>
<div class="modal fade" id="suggestionModal" tabindex="-1" aria-labelledby="suggestionModalLabel" aria-hidden="true"
  data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center p-4 position-relative suggestion-modal-content">
      <button type="button" class="btn-close position-absolute top-right-10" (click)="closeSuggestionModal()"
        aria-label="Close"></button>
      <div class="modal-body mt-2 suggestion-modal-body">
        <h5 class="modal-title mb-3" id="suggestionModalLabel">
          Service Not Available in Your Areas
        </h5>
        <p class="text-muted mb-0">
          Sorry, we are not providing service in your area yet. Please select
          another location.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="reviewsModal" tabindex="-1" aria-labelledby="reviewsModalLabel" aria-hidden="true"
  data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog">
    <div class="modal-content p-1">
      <div class="modal-header border-bottom py-2">
        <h5 class="modal-title fw-bold">
          {{ "home.reviews.title" | translate }}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-2">
        <div *ngIf="loadingReviews" class="text-center p-2">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="text-muted mt-2 mb-0">Fetching reviews...</p>
        </div>
        <div *ngIf="!loadingReviews">
          <div *ngFor="let review of selectedServiceReviews" class="review-card mb-2 pb-2 border-bottom">
            <div class="d-flex align-items-center mb-1">
              <img [src]="
                  review.PROFILE_PHOTO
                    ? IMAGEuRL + 'CustomerProfile/' + review.PROFILE_PHOTO
                    : 'assets/img/userimage.jpg'
                " class="rounded-circle me-2" width="36" height="36" />
              <div>
                <strong class="d-block small">{{
                  review.CUSTOMER_NAME
                  }}</strong>
              </div>
            </div>
            <div class="rating mb-1">
              <ng-container *ngFor="let star of [1, 2, 3, 4, 5]; let i = index">
                <i class="bi" [ngClass]="
                    +review.RATING >= i + 1
                      ? 'bi-star-fill text-warning'
                      : 'bi-star text-secondary'
                  "></i>
              </ng-container>
            </div>
            <p class="mt-1 mb-0 text-muted fst-italic small ws-pre-line" *ngIf="review != undefined && review.COMMENTS">
              "{{ review.COMMENTS }}"
            </p>
          </div>
          <p *ngIf="selectedServiceReviews.length === 0" class="text-center text-muted small mb-0">
            No reviews available.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="addressmodalSubCatClick" tabindex="-1" aria-labelledby="addressmodalSubCatClickLabel"
  aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog">
    <div class="modal-content p-1 transparent-bg-no-border">
      <div class="modal-body p-2">
        <div *ngIf="modalVisible">
          <div class="map-container">
            <div class="map-header primary-flex-header">
              <div class="flex-align-space-between-full">
                <div>
                  <p class="mb-0 heading-white-bold-16">
                    User Location (Place the marker at your order location)
                  </p>
                </div>
                <div>
                  <button type="button" class="white-text-transparent-btn" data-bs-dismiss="modal"
                    (click)="closeaddressmodalSubCatClick()" aria-label="Close">
                    <i class="bi bi-x icon-size-26-no-padding"></i>
                  </button>
                </div>
              </div>
              <div class="text-end-p-6" *ngIf="gettruecondition()">
                <button class="close-menu-btn" (click)="closeMap()">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                </button>
              </div>
            </div>
            <div id="map"></div>
            <div class="location-details  text-center">
              <p class="address-text">{{ locationAddress || "Fetching address..." }}</p>
            </div>
            <div class="map-footer">
              <button [disabled]="!locationAddress" class="btn-primary1" (click)="confirmLocation()">
                Confirm Location
              </button>
            </div>
          </div>
        </div>
        <div *ngIf="showAddressDetailsForm" class="address-form-container">
          <div class="card shadow-sm address-form-card no-border">
            <div
              class="card-header position-relative d-flex align-items-center justify-content-center height-80-no-bottom-border">
              <div class="icon-wrapper text-center">
                <svg width="66" height="67" viewBox="0 0 66 67" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="33" cy="33.5" r="32.7988" stroke="#FFDFBE" stroke-width="0.402439" />
                  <circle cx="33.0004" cy="33.5" r="26.3598" stroke="#FFDFBE" stroke-width="0.402439" />
                  <path
                    d="M20.6299 39.7112C16.1906 33.6198 16.8468 25.2031 22.1766 19.8733C28.154 13.8959 37.8454 13.8959 43.8228 19.8733C49.1526 25.2031 49.8088 33.6198 45.3695 39.7112L36.0195 52.541C34.5271 54.5888 31.4723 54.5888 29.9799 52.541L20.6299 39.7112Z"
                    fill="#2A3B8F" />
                  <circle cx="33.0137" cy="31.5595" r="5.97857" fill="#FDEEE9" />
                </svg>
              </div>
              <div>
                <button type="button" class="close-btn" data-bs-dismiss="modal" (click)="closeaddressmodalSubCatClick()"
                  aria-label="Close">
                  <i class="bi bi-x icon-size-26-no-padding"></i>
                </button>
              </div>
            </div>
            <form #addressSubmit="ngForm" (ngSubmit)="saveAddressAdd(addressSubmit)" class="p-3">
              <div class="scrollable-container">
                <h2 class="form-title mb-0 ms-3 padding-bottom-15-font-17">
                  Enter address details
                </h2>
                <div class="mb-3 rounded-padded-bg">
                  <label class="form-label text-muted small flex-display">Save address as *</label>
                  <div class="btn-group custom-btn-group">
                    <button type="button" class="btn mr-10-important" [ngClass]="{
                        'btn-outline-primary': addressForm.TYPE !== 'H',
                        'btn-primary': addressForm.TYPE === 'H',
                        colorcodes: addressForm.TYPE === 'H'
                      }" (click)="addressForm.TYPE = 'H'">
                      Home
                    </button>
                    <button type="button" class="btn mr-10-important" [ngClass]="{
                        'btn-outline-primary': addressForm.TYPE !== 'F',
                        'btn-primary': addressForm.TYPE === 'F',
                        colorcodes: addressForm.TYPE === 'F'
                      }" (click)="addressForm.TYPE = 'F'">
                      Work
                    </button>
                    <button type="button" class="btn mr-10-important ml-10" [ngClass]="{
                        'btn-outline-primary': addressForm.TYPE !== 'O',
                        'btn-primary': addressForm.TYPE === 'O',
                        colorcodes: addressForm.TYPE === 'O'
                      }" (click)="addressForm.TYPE = 'O'">
                      Other
                    </button>
                  </div>
                </div>
                <div class="mb-3 contact-details" *ngIf="!asGuest">
                  <label class="form-label fs-13">Contact Person Details</label>
                  <div class="fs-13">
                    {{ data.CUSTOMER_NAME }}
                    <b>{{ data.CUSTOMER_MOBILE_NO }}</b>
                  </div>
                </div>
                <div class="rounded-padded-bg">
                  <div class="form-group position-relative service-card">
                    <button type="button" class="btn btn-link position-absolute end-0 top-50 translate-middle-y fs-13"
                      (click)="onshowMap()">
                      Change Location
                    </button>
                  </div>
                  <div class="row mt-2">
                    <div class="col-md-6">
                      <input type="text" class="form-control" placeholder="House number/flat no/floor no"
                        [(ngModel)]="addressForm.ADDRESS_LINE_1" name="addressLine1" required #addressLine1="ngModel"
                        autocomplete="off" maxlength="256" />
                      <div *ngIf="(addressLine1.errors?.['required'] && (addressLine1.touched || addressSubmitted))"
                        class="error-message">
                        Please enter house number/flat no/floor no.
                      </div>
                    </div>
                    <div class="col-md-6">
                      <input type="text" class="form-control" placeholder="Area/street/village"
                        [(ngModel)]="addressForm.ADDRESS_LINE_2" name="addressLine2" autocomplete="off" required
                        #addressLine2="ngModel" maxlength="256" />
                      <div *ngIf="(addressLine2.errors?.['required'] && (addressLine2.touched || addressSubmitted))"
                        class="error-message">
                        Please enter Area/street/village.
                      </div>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-md-6">
                      <input type="text" class="form-control" placeholder="Landmark (optional)"
                        [(ngModel)]="addressForm.LANDMARK" name="landmark" autocomplete="off" maxlength="128" />
                    </div>
                    <div class="col-md-6">
                      <div class="position-relative">
                        <div class="dropdown-wrapper">
                          <input type="text" class="form-control" [(ngModel)]="selectedPincode"
                            placeholder="Select pincode" name="pincode" #pincode="ngModel" required maxlength="64"
                            readonly autocomplete="off" />
                          <div *ngIf="isPincodeLoading" class="loading-container1 spinner-inside">
                            <div class="spinner-border text-center" role="status">
                              <span class="visually-hidden">Loading...</span>
                            </div>
                          </div>
                        </div>
                        <div *ngIf="
                            pincode.invalid &&
                            (pincode.touched || addressSubmitted)
                          " class="text-danger mt-1 fs-12">
                          <div *ngIf="pincode.errors?.['required']">
                            Please select pincode.
                          </div>
                          <div *ngIf="pincode.errors?.['maxlength']">
                            Max length exceeded.
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-md-6">
                      <input type="text" class="form-control" [(ngModel)]="addressForm.CITY_NAME"
                        [placeholder]="'Enter City'" name="CITY_NAME" autocomplete="off" maxlength="128" required
                        #CITY_NAME="ngModel" />
                      <div *ngIf="(CITY_NAME.errors?.['required'] && (CITY_NAME.touched || addressSubmitted))"
                        class="error-message">
                        Please enter City.
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="position-relative">
                        <div class="dropdown-wrapper" (click)="
                            toggleStatesDropdown(); $event.stopPropagation()
                          ">
                          <input type="text" class="form-control" [value]="selectedState || 'Select State...'" readonly
                            autocomplete="off" />
                          <span class="dropdown-icon"></span>
                        </div>
                        <div *ngIf="showStateDropdown" class="dropdown-menu show">
                          <input type="text" class="form-control" placeholder="Search State..."
                            [(ngModel)]="searchState" name="stateSearch" (input)="filterStates($event)"
                            (click)="$event.stopPropagation()" autocomplete="off" />
                          <div class="dropdown-item" *ngFor="let state of filteredStates" (click)="selectState(state)">
                            {{ state.NAME }}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="d-flex justify-content-center mt-3">
                  <button [disabled]="isAddrssSaving" type="submit" class="btn btn-primary w-100">
                    <span *ngIf="isAddrssSaving" class="spinner-border spinner-border-sm me-2"></span>
                    Confirm
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div *ngIf="guestuser" class="modal fade show fullscreen-overlay" id="guestModal" tabindex="-1"
  aria-labelledby="guestModalLabel" aria-hidden="false" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog modal-dialog-centered centered-flex-container">
    <div class="modal-content card-fadein">
      <div class="modal-header border-0">
        <h5 class="fw-bold m-auto text-333-fs-20">
          <i class="bi bi-person-circle"></i> You are a Guest
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
          (click)="closeloginmodal()"></button>
      </div>
      <div class="modal-body">
        <p class="fs-15-color-555-line-15">
          Please <strong>login</strong> to add an item to your cart and enjoy
          seamless service.
        </p>
      </div>
      <div class="modal-footer border-0 d-flex justify-content-center">
        <button type="button" class="btn btn-outline-dark px-4 py-2 rounded-pill border-black transition-fw-500"
          data-bs-dismiss="modal" (click)="closeloginmodal()">
          <i class="bi bi-x-circle"></i> Cancel
        </button>
        <button type="button" class="btn btn-primary px-4 py-2 rounded-pill btn-blue-500" (click)="redirectToLogin()">
          <i class="bi bi-box-arrow-in-right"></i> Login
        </button>
      </div>
    </div>
  </div>
</div>
<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(40px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
<div #feedbackModal class="modal fade" id="feedbackModal" tabindex="-1" data-bs-backdrop="static"
  data-bs-keyboard="false" aria-labelledby="feedbackModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content feedback-modal-content">
      <div class="modal-header feedback-modal-header">
        <h6 class="modal-title fw-semibold d-flex align-items-center">
          <i class="bi bi-record-circle-fill me-1 text-blue-dark"></i>
          Rate Us
        </h6>
        <button type="button" class="btn-close" (click)="closeFeedbackModal()"></button>
      </div>
      <div class="modal-body feedback-modal-body">
        <form #feedbackForm="ngForm" class="feedback-form" (ngSubmit)="submitFeedback()">
          <p class="fw-medium text-dark mb-1 font-13">
            How would you rate the experience and service?
          </p>
          <div class="d-flex gap-1 justify-content-left mb-2">
            <i class="bi font-14-pointer" [ngClass]="
                  rating >= star
                    ? 'bi-star-fill text-warning'
                    : 'bi-star text-muted'
                " *ngFor="let star of [1, 2, 3, 4, 5]" (click)="setRating(star, 'service')"></i>
          </div>
          <textarea class="form-control bg-light rounded-2 border-0 p-2 text-12-full-width" name="comment"
            [(ngModel)]="feedback.comment" placeholder="Tell us on how we can improve" rows="2"
            maxlength="256"></textarea>
          <p class="fw-medium text-dark mt-2 mb-1 font-13">
            How would you rate the technician assigned for this service?
          </p>
          <div class="d-flex gap-1 justify-content-left mb-2">
            <i class="bi font-14-pointer" [ngClass]="
                  techRating >= star
                    ? 'bi-star-fill text-warning'
                    : 'bi-star text-muted'
                " *ngFor="let star of [1, 2, 3, 4, 5]" (click)="setRating(star, 'technician')"></i>
          </div>
          <textarea class="form-control bg-light rounded-2 border-0 p-2 text-12-full-width" name="comment1"
            [(ngModel)]="feedback.comment1" placeholder="Share your experience with our technician" rows="2"
            maxlength="256"></textarea>
          <div class="modal-footer border-0 pt-3 py-10">
            <button type="submit" class="btn w-100 py-2 rounded-2 fw-medium text-white-bg-blue"
              [disabled]="rating === 0 || techRating === 0">
              Submit
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<div class="rate-overlay" *ngIf="showRatePopup">
  <div class="rate-popup-bottom" [class.slide-in]="!isClosing" [class.slide-out]="isClosing">
    <div class="popup-content">
      <div class="popup-icon">
        <i class="bi bi-check-circle-fill"></i>
      </div>
      <div class="popup-text">
        <h4>{{ data?.SERVICE_NAME }} Completed</h4>
        <p>Your service has been completed successfully.</p>
      </div>
      <div class="popup-actions">
        <button class="btn-submit" (click)="openFeedbackModal()">
          Rate Service
        </button>
        <button class="btn-later" (click)="closePopup()">
          Later
        </button>
      </div>
    </div>
  </div>
</div>
<div class="rate-overlay" *ngIf="showSuccessPopup">
  <div class="rate-popup-bottom success-popup" [class.slide-in]="!isClosingSuccess"
    [class.slide-out]="isClosingSuccess">
    <div class="popup-content center-content">
      <div class="popup-icon success-icon">
        ‚≠ê
      </div>
      <div class="popup-text text-center">
        <h4>Feedback submitted successfully!</h4>
        <p>Thanks for letting us know</p>
      </div>
    </div>
  </div>
</div>